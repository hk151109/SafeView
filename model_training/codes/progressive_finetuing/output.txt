==================================================
Step 1: Creating and preparing datasets...
Found 19600 files belonging to 5 classes.
2025-04-21 17:13:47.051459: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Found 4200 files belonging to 5 classes.
Found 4200 files belonging to 5 classes.

Step 2: Computing class weights...
2025-04-21 17:13:56.477139: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Class distribution: {3: 3920, 1: 3920, 2: 3920, 4: 3920, 0: 3920}
Raw class weights: {3: 1.0, 1: 1.0, 2: 1.0, 4: 1.0, 0: 1.0}
Smoothed class weights: {3: 1.0, 1: 1.0, 2: 1.0, 4: 1.0, 0: 1.0}

Step 3: Creating base model architecture...
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_layer (InputLayer)      │ (None, 224, 224, 3)       │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ rescaling (Rescaling)         │ (None, 224, 224, 3)       │               0 │ input_layer[0][0]          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv (Conv2D)                 │ (None, 112, 112, 16)      │             432 │ rescaling[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv_bn (BatchNormalization)  │ (None, 112, 112, 16)      │              64 │ conv[0][0]                 │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation (Activation)       │ (None, 112, 112, 16)      │               0 │ conv_bn[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise_pad   │ (None, 113, 113, 16)      │               0 │ activation[0][0]           │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise       │ (None, 56, 56, 16)        │             144 │ expanded_conv_depthwise_p… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_depthwise_bn    │ (None, 56, 56, 16)        │              64 │ expanded_conv_depthwise[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu (ReLU)                  │ (None, 56, 56, 16)        │               0 │ expanded_conv_depthwise_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_squeeze_excite… │ (None, 1, 1, 16)          │               0 │ re_lu[0][0]                │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_squeeze_excite… │ (None, 1, 1, 8)           │             136 │ expanded_conv_squeeze_exc… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_squeeze_excite… │ (None, 1, 1, 8)           │               0 │ expanded_conv_squeeze_exc… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_squeeze_excite… │ (None, 1, 1, 16)          │             144 │ expanded_conv_squeeze_exc… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add (Add)                     │ (None, 1, 1, 16)          │               0 │ expanded_conv_squeeze_exc… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_1 (ReLU)                │ (None, 1, 1, 16)          │               0 │ add[0][0]                  │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply (Multiply)           │ (None, 1, 1, 16)          │               0 │ re_lu_1[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_squeeze_excite… │ (None, 56, 56, 16)        │               0 │ re_lu[0][0],               │
│ (Multiply)                    │                           │                 │ multiply[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_project         │ (None, 56, 56, 16)        │             256 │ expanded_conv_squeeze_exc… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_project_bn      │ (None, 56, 56, 16)        │              64 │ expanded_conv_project[0][… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_expand        │ (None, 56, 56, 72)        │           1,152 │ expanded_conv_project_bn[… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_expand_bn     │ (None, 56, 56, 72)        │             288 │ expanded_conv_1_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_2 (ReLU)                │ (None, 56, 56, 72)        │               0 │ expanded_conv_1_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_depthwise_pad │ (None, 57, 57, 72)        │               0 │ re_lu_2[0][0]              │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_depthwise     │ (None, 28, 28, 72)        │             648 │ expanded_conv_1_depthwise… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_depthwise_bn  │ (None, 28, 28, 72)        │             288 │ expanded_conv_1_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_3 (ReLU)                │ (None, 28, 28, 72)        │               0 │ expanded_conv_1_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_project       │ (None, 28, 28, 24)        │           1,728 │ re_lu_3[0][0]              │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_1_project_bn    │ (None, 28, 28, 24)        │              96 │ expanded_conv_1_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_expand        │ (None, 28, 28, 88)        │           2,112 │ expanded_conv_1_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_expand_bn     │ (None, 28, 28, 88)        │             352 │ expanded_conv_2_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_4 (ReLU)                │ (None, 28, 28, 88)        │               0 │ expanded_conv_2_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_depthwise     │ (None, 28, 28, 88)        │             792 │ re_lu_4[0][0]              │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_depthwise_bn  │ (None, 28, 28, 88)        │             352 │ expanded_conv_2_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_5 (ReLU)                │ (None, 28, 28, 88)        │               0 │ expanded_conv_2_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_project       │ (None, 28, 28, 24)        │           2,112 │ re_lu_5[0][0]              │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_project_bn    │ (None, 28, 28, 24)        │              96 │ expanded_conv_2_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_2_add (Add)     │ (None, 28, 28, 24)        │               0 │ expanded_conv_1_project_b… │
│                               │                           │                 │ expanded_conv_2_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_expand        │ (None, 28, 28, 96)        │           2,304 │ expanded_conv_2_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_expand_bn     │ (None, 28, 28, 96)        │             384 │ expanded_conv_3_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_1 (Activation)     │ (None, 28, 28, 96)        │               0 │ expanded_conv_3_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_depthwise_pad │ (None, 31, 31, 96)        │               0 │ activation_1[0][0]         │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_depthwise     │ (None, 14, 14, 96)        │           2,400 │ expanded_conv_3_depthwise… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_depthwise_bn  │ (None, 14, 14, 96)        │             384 │ expanded_conv_3_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_2 (Activation)     │ (None, 14, 14, 96)        │               0 │ expanded_conv_3_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 96)          │               0 │ activation_2[0][0]         │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 24)          │           2,328 │ expanded_conv_3_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 24)          │               0 │ expanded_conv_3_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 1, 1, 96)          │           2,400 │ expanded_conv_3_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_1 (Add)                   │ (None, 1, 1, 96)          │               0 │ expanded_conv_3_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_6 (ReLU)                │ (None, 1, 1, 96)          │               0 │ add_1[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_1 (Multiply)         │ (None, 1, 1, 96)          │               0 │ re_lu_6[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_squeeze_exci… │ (None, 14, 14, 96)        │               0 │ activation_2[0][0],        │
│ (Multiply)                    │                           │                 │ multiply_1[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_project       │ (None, 14, 14, 40)        │           3,840 │ expanded_conv_3_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_3_project_bn    │ (None, 14, 14, 40)        │             160 │ expanded_conv_3_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_expand        │ (None, 14, 14, 240)       │           9,600 │ expanded_conv_3_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_expand_bn     │ (None, 14, 14, 240)       │             960 │ expanded_conv_4_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_3 (Activation)     │ (None, 14, 14, 240)       │               0 │ expanded_conv_4_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_depthwise     │ (None, 14, 14, 240)       │           6,000 │ activation_3[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_depthwise_bn  │ (None, 14, 14, 240)       │             960 │ expanded_conv_4_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_4 (Activation)     │ (None, 14, 14, 240)       │               0 │ expanded_conv_4_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 240)         │               0 │ activation_4[0][0]         │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 64)          │          15,424 │ expanded_conv_4_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 64)          │               0 │ expanded_conv_4_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 1, 1, 240)         │          15,600 │ expanded_conv_4_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_2 (Add)                   │ (None, 1, 1, 240)         │               0 │ expanded_conv_4_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_7 (ReLU)                │ (None, 1, 1, 240)         │               0 │ add_2[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_2 (Multiply)         │ (None, 1, 1, 240)         │               0 │ re_lu_7[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_squeeze_exci… │ (None, 14, 14, 240)       │               0 │ activation_4[0][0],        │
│ (Multiply)                    │                           │                 │ multiply_2[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_project       │ (None, 14, 14, 40)        │           9,600 │ expanded_conv_4_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_project_bn    │ (None, 14, 14, 40)        │             160 │ expanded_conv_4_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_4_add (Add)     │ (None, 14, 14, 40)        │               0 │ expanded_conv_3_project_b… │
│                               │                           │                 │ expanded_conv_4_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_expand        │ (None, 14, 14, 240)       │           9,600 │ expanded_conv_4_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_expand_bn     │ (None, 14, 14, 240)       │             960 │ expanded_conv_5_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_5 (Activation)     │ (None, 14, 14, 240)       │               0 │ expanded_conv_5_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_depthwise     │ (None, 14, 14, 240)       │           6,000 │ activation_5[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_depthwise_bn  │ (None, 14, 14, 240)       │             960 │ expanded_conv_5_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_6 (Activation)     │ (None, 14, 14, 240)       │               0 │ expanded_conv_5_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 240)         │               0 │ activation_6[0][0]         │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 64)          │          15,424 │ expanded_conv_5_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 64)          │               0 │ expanded_conv_5_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 1, 1, 240)         │          15,600 │ expanded_conv_5_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_3 (Add)                   │ (None, 1, 1, 240)         │               0 │ expanded_conv_5_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_8 (ReLU)                │ (None, 1, 1, 240)         │               0 │ add_3[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_3 (Multiply)         │ (None, 1, 1, 240)         │               0 │ re_lu_8[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_squeeze_exci… │ (None, 14, 14, 240)       │               0 │ activation_6[0][0],        │
│ (Multiply)                    │                           │                 │ multiply_3[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_project       │ (None, 14, 14, 40)        │           9,600 │ expanded_conv_5_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_project_bn    │ (None, 14, 14, 40)        │             160 │ expanded_conv_5_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_5_add (Add)     │ (None, 14, 14, 40)        │               0 │ expanded_conv_4_add[0][0], │
│                               │                           │                 │ expanded_conv_5_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_expand        │ (None, 14, 14, 120)       │           4,800 │ expanded_conv_5_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_expand_bn     │ (None, 14, 14, 120)       │             480 │ expanded_conv_6_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_7 (Activation)     │ (None, 14, 14, 120)       │               0 │ expanded_conv_6_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_depthwise     │ (None, 14, 14, 120)       │           3,000 │ activation_7[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_depthwise_bn  │ (None, 14, 14, 120)       │             480 │ expanded_conv_6_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_8 (Activation)     │ (None, 14, 14, 120)       │               0 │ expanded_conv_6_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_squeeze_exci… │ (None, 1, 1, 120)         │               0 │ activation_8[0][0]         │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_squeeze_exci… │ (None, 1, 1, 32)          │           3,872 │ expanded_conv_6_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_squeeze_exci… │ (None, 1, 1, 32)          │               0 │ expanded_conv_6_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_squeeze_exci… │ (None, 1, 1, 120)         │           3,960 │ expanded_conv_6_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_4 (Add)                   │ (None, 1, 1, 120)         │               0 │ expanded_conv_6_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_9 (ReLU)                │ (None, 1, 1, 120)         │               0 │ add_4[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_4 (Multiply)         │ (None, 1, 1, 120)         │               0 │ re_lu_9[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_squeeze_exci… │ (None, 14, 14, 120)       │               0 │ activation_8[0][0],        │
│ (Multiply)                    │                           │                 │ multiply_4[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_project       │ (None, 14, 14, 48)        │           5,760 │ expanded_conv_6_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_6_project_bn    │ (None, 14, 14, 48)        │             192 │ expanded_conv_6_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_expand        │ (None, 14, 14, 144)       │           6,912 │ expanded_conv_6_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_expand_bn     │ (None, 14, 14, 144)       │             576 │ expanded_conv_7_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_9 (Activation)     │ (None, 14, 14, 144)       │               0 │ expanded_conv_7_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_depthwise     │ (None, 14, 14, 144)       │           3,600 │ activation_9[0][0]         │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_depthwise_bn  │ (None, 14, 14, 144)       │             576 │ expanded_conv_7_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_10 (Activation)    │ (None, 14, 14, 144)       │               0 │ expanded_conv_7_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_squeeze_exci… │ (None, 1, 1, 144)         │               0 │ activation_10[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_squeeze_exci… │ (None, 1, 1, 40)          │           5,800 │ expanded_conv_7_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_squeeze_exci… │ (None, 1, 1, 40)          │               0 │ expanded_conv_7_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_squeeze_exci… │ (None, 1, 1, 144)         │           5,904 │ expanded_conv_7_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_5 (Add)                   │ (None, 1, 1, 144)         │               0 │ expanded_conv_7_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_10 (ReLU)               │ (None, 1, 1, 144)         │               0 │ add_5[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_5 (Multiply)         │ (None, 1, 1, 144)         │               0 │ re_lu_10[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_squeeze_exci… │ (None, 14, 14, 144)       │               0 │ activation_10[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_5[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_project       │ (None, 14, 14, 48)        │           6,912 │ expanded_conv_7_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_project_bn    │ (None, 14, 14, 48)        │             192 │ expanded_conv_7_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_7_add (Add)     │ (None, 14, 14, 48)        │               0 │ expanded_conv_6_project_b… │
│                               │                           │                 │ expanded_conv_7_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_expand        │ (None, 14, 14, 288)       │          13,824 │ expanded_conv_7_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_expand_bn     │ (None, 14, 14, 288)       │           1,152 │ expanded_conv_8_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_11 (Activation)    │ (None, 14, 14, 288)       │               0 │ expanded_conv_8_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_depthwise_pad │ (None, 17, 17, 288)       │               0 │ activation_11[0][0]        │
│ (ZeroPadding2D)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_depthwise     │ (None, 7, 7, 288)         │           7,200 │ expanded_conv_8_depthwise… │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_depthwise_bn  │ (None, 7, 7, 288)         │           1,152 │ expanded_conv_8_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_12 (Activation)    │ (None, 7, 7, 288)         │               0 │ expanded_conv_8_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_squeeze_exci… │ (None, 1, 1, 288)         │               0 │ activation_12[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_squeeze_exci… │ (None, 1, 1, 72)          │          20,808 │ expanded_conv_8_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_squeeze_exci… │ (None, 1, 1, 72)          │               0 │ expanded_conv_8_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_squeeze_exci… │ (None, 1, 1, 288)         │          21,024 │ expanded_conv_8_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_6 (Add)                   │ (None, 1, 1, 288)         │               0 │ expanded_conv_8_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_11 (ReLU)               │ (None, 1, 1, 288)         │               0 │ add_6[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_6 (Multiply)         │ (None, 1, 1, 288)         │               0 │ re_lu_11[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_squeeze_exci… │ (None, 7, 7, 288)         │               0 │ activation_12[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_6[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_project       │ (None, 7, 7, 96)          │          27,648 │ expanded_conv_8_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_8_project_bn    │ (None, 7, 7, 96)          │             384 │ expanded_conv_8_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_expand        │ (None, 7, 7, 576)         │          55,296 │ expanded_conv_8_project_b… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_expand_bn     │ (None, 7, 7, 576)         │           2,304 │ expanded_conv_9_expand[0]… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_13 (Activation)    │ (None, 7, 7, 576)         │               0 │ expanded_conv_9_expand_bn… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_depthwise     │ (None, 7, 7, 576)         │          14,400 │ activation_13[0][0]        │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_depthwise_bn  │ (None, 7, 7, 576)         │           2,304 │ expanded_conv_9_depthwise… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_14 (Activation)    │ (None, 7, 7, 576)         │               0 │ expanded_conv_9_depthwise… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_squeeze_exci… │ (None, 1, 1, 576)         │               0 │ activation_14[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_squeeze_exci… │ (None, 1, 1, 144)         │          83,088 │ expanded_conv_9_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_squeeze_exci… │ (None, 1, 1, 144)         │               0 │ expanded_conv_9_squeeze_e… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_squeeze_exci… │ (None, 1, 1, 576)         │          83,520 │ expanded_conv_9_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_7 (Add)                   │ (None, 1, 1, 576)         │               0 │ expanded_conv_9_squeeze_e… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_12 (ReLU)               │ (None, 1, 1, 576)         │               0 │ add_7[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_7 (Multiply)         │ (None, 1, 1, 576)         │               0 │ re_lu_12[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_squeeze_exci… │ (None, 7, 7, 576)         │               0 │ activation_14[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_7[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_project       │ (None, 7, 7, 96)          │          55,296 │ expanded_conv_9_squeeze_e… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_project_bn    │ (None, 7, 7, 96)          │             384 │ expanded_conv_9_project[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_9_add (Add)     │ (None, 7, 7, 96)          │               0 │ expanded_conv_8_project_b… │
│                               │                           │                 │ expanded_conv_9_project_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_expand       │ (None, 7, 7, 576)         │          55,296 │ expanded_conv_9_add[0][0]  │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_expand_bn    │ (None, 7, 7, 576)         │           2,304 │ expanded_conv_10_expand[0… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_15 (Activation)    │ (None, 7, 7, 576)         │               0 │ expanded_conv_10_expand_b… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_depthwise    │ (None, 7, 7, 576)         │          14,400 │ activation_15[0][0]        │
│ (DepthwiseConv2D)             │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_depthwise_bn │ (None, 7, 7, 576)         │           2,304 │ expanded_conv_10_depthwis… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_16 (Activation)    │ (None, 7, 7, 576)         │               0 │ expanded_conv_10_depthwis… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 576)         │               0 │ activation_16[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 144)         │          83,088 │ expanded_conv_10_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 144)         │               0 │ expanded_conv_10_squeeze_… │
│ (ReLU)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 1, 1, 576)         │          83,520 │ expanded_conv_10_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ add_8 (Add)                   │ (None, 1, 1, 576)         │               0 │ expanded_conv_10_squeeze_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ re_lu_13 (ReLU)               │ (None, 1, 1, 576)         │               0 │ add_8[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ multiply_8 (Multiply)         │ (None, 1, 1, 576)         │               0 │ re_lu_13[0][0]             │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_squeeze_exc… │ (None, 7, 7, 576)         │               0 │ activation_16[0][0],       │
│ (Multiply)                    │                           │                 │ multiply_8[0][0]           │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_project      │ (None, 7, 7, 96)          │          55,296 │ expanded_conv_10_squeeze_… │
│ (Conv2D)                      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_project_bn   │ (None, 7, 7, 96)          │             384 │ expanded_conv_10_project[… │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ expanded_conv_10_add (Add)    │ (None, 7, 7, 96)          │               0 │ expanded_conv_9_add[0][0], │
│                               │                           │                 │ expanded_conv_10_project_… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv_1 (Conv2D)               │ (None, 7, 7, 576)         │          55,296 │ expanded_conv_10_add[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conv_1_bn                     │ (None, 7, 7, 576)         │           2,304 │ conv_1[0][0]               │
│ (BatchNormalization)          │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ activation_17 (Activation)    │ (None, 7, 7, 576)         │               0 │ conv_1_bn[0][0]            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ global_average_pooling2d      │ (None, 576)               │               0 │ activation_17[0][0]        │
│ (GlobalAveragePooling2D)      │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense (Dense)                 │ (None, 256)               │         147,712 │ global_average_pooling2d[… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout (Dropout)             │ (None, 256)               │               0 │ dense[0][0]                │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense_1 (Dense)               │ (None, 128)               │          32,896 │ dropout[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout_1 (Dropout)           │ (None, 128)               │               0 │ dense_1[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dense_2 (Dense)               │ (None, 5)                 │             645 │ dropout_1[0][0]            │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 1,120,373 (4.27 MB)
 Trainable params: 181,253 (708.02 KB)
 Non-trainable params: 939,120 (3.58 MB)

Model Layer Status:
Layer 0: input_layer - Frozen
Layer 1: rescaling - Frozen
Layer 2: conv - Frozen
Layer 3: conv_bn - Frozen
Layer 4: activation - Frozen
Layer 5: expanded_conv_depthwise_pad - Frozen
Layer 6: expanded_conv_depthwise - Frozen
Layer 7: expanded_conv_depthwise_bn - Frozen
Layer 8: re_lu - Frozen
Layer 9: expanded_conv_squeeze_excite_avg_pool - Frozen
Layer 10: expanded_conv_squeeze_excite_conv - Frozen
Layer 11: expanded_conv_squeeze_excite_relu - Frozen
Layer 12: expanded_conv_squeeze_excite_conv_1 - Frozen
Layer 13: re_lu_1 - Frozen
Layer 14: expanded_conv_squeeze_excite_mul - Frozen
Layer 15: expanded_conv_project - Frozen
Layer 16: expanded_conv_project_bn - Frozen
Layer 17: expanded_conv_1_expand - Frozen
Layer 18: expanded_conv_1_expand_bn - Frozen
Layer 19: re_lu_2 - Frozen
Layer 20: expanded_conv_1_depthwise_pad - Frozen
Layer 21: expanded_conv_1_depthwise - Frozen
Layer 22: expanded_conv_1_depthwise_bn - Frozen
Layer 23: re_lu_3 - Frozen
Layer 24: expanded_conv_1_project - Frozen
Layer 25: expanded_conv_1_project_bn - Frozen
Layer 26: expanded_conv_2_expand - Frozen
Layer 27: expanded_conv_2_expand_bn - Frozen
Layer 28: re_lu_4 - Frozen
Layer 29: expanded_conv_2_depthwise - Frozen
Layer 30: expanded_conv_2_depthwise_bn - Frozen
Layer 31: re_lu_5 - Frozen
Layer 32: expanded_conv_2_project - Frozen
Layer 33: expanded_conv_2_project_bn - Frozen
Layer 34: expanded_conv_2_add - Frozen
Layer 35: expanded_conv_3_expand - Frozen
Layer 36: expanded_conv_3_expand_bn - Frozen
Layer 37: activation_1 - Frozen
Layer 38: expanded_conv_3_depthwise_pad - Frozen
Layer 39: expanded_conv_3_depthwise - Frozen
Layer 40: expanded_conv_3_depthwise_bn - Frozen
Layer 41: activation_2 - Frozen
Layer 42: expanded_conv_3_squeeze_excite_avg_pool - Frozen
Layer 43: expanded_conv_3_squeeze_excite_conv - Frozen
Layer 44: expanded_conv_3_squeeze_excite_relu - Frozen
Layer 45: expanded_conv_3_squeeze_excite_conv_1 - Frozen
Layer 46: re_lu_6 - Frozen
Layer 47: expanded_conv_3_squeeze_excite_mul - Frozen
Layer 48: expanded_conv_3_project - Frozen
Layer 49: expanded_conv_3_project_bn - Frozen
Layer 50: expanded_conv_4_expand - Frozen
Layer 51: expanded_conv_4_expand_bn - Frozen
Layer 52: activation_3 - Frozen
Layer 53: expanded_conv_4_depthwise - Frozen
Layer 54: expanded_conv_4_depthwise_bn - Frozen
Layer 55: activation_4 - Frozen
Layer 56: expanded_conv_4_squeeze_excite_avg_pool - Frozen
Layer 57: expanded_conv_4_squeeze_excite_conv - Frozen
Layer 58: expanded_conv_4_squeeze_excite_relu - Frozen
Layer 59: expanded_conv_4_squeeze_excite_conv_1 - Frozen
Layer 60: re_lu_7 - Frozen
Layer 61: expanded_conv_4_squeeze_excite_mul - Frozen
Layer 62: expanded_conv_4_project - Frozen
Layer 63: expanded_conv_4_project_bn - Frozen
Layer 64: expanded_conv_4_add - Frozen
Layer 65: expanded_conv_5_expand - Frozen
Layer 66: expanded_conv_5_expand_bn - Frozen
Layer 67: activation_5 - Frozen
Layer 68: expanded_conv_5_depthwise - Frozen
Layer 69: expanded_conv_5_depthwise_bn - Frozen
Layer 70: activation_6 - Frozen
Layer 71: expanded_conv_5_squeeze_excite_avg_pool - Frozen
Layer 72: expanded_conv_5_squeeze_excite_conv - Frozen
Layer 73: expanded_conv_5_squeeze_excite_relu - Frozen
Layer 74: expanded_conv_5_squeeze_excite_conv_1 - Frozen
Layer 75: re_lu_8 - Frozen
Layer 76: expanded_conv_5_squeeze_excite_mul - Frozen
Layer 77: expanded_conv_5_project - Frozen
Layer 78: expanded_conv_5_project_bn - Frozen
Layer 79: expanded_conv_5_add - Frozen
Layer 80: expanded_conv_6_expand - Frozen
Layer 81: expanded_conv_6_expand_bn - Frozen
Layer 82: activation_7 - Frozen
Layer 83: expanded_conv_6_depthwise - Frozen
Layer 84: expanded_conv_6_depthwise_bn - Frozen
Layer 85: activation_8 - Frozen
Layer 86: expanded_conv_6_squeeze_excite_avg_pool - Frozen
Layer 87: expanded_conv_6_squeeze_excite_conv - Frozen
Layer 88: expanded_conv_6_squeeze_excite_relu - Frozen
Layer 89: expanded_conv_6_squeeze_excite_conv_1 - Frozen
Layer 90: re_lu_9 - Frozen
Layer 91: expanded_conv_6_squeeze_excite_mul - Frozen
Layer 92: expanded_conv_6_project - Frozen
Layer 93: expanded_conv_6_project_bn - Frozen
Layer 94: expanded_conv_7_expand - Frozen
Layer 95: expanded_conv_7_expand_bn - Frozen
Layer 96: activation_9 - Frozen
Layer 97: expanded_conv_7_depthwise - Frozen
Layer 98: expanded_conv_7_depthwise_bn - Frozen
Layer 99: activation_10 - Frozen
Layer 100: expanded_conv_7_squeeze_excite_avg_pool - Frozen
Layer 101: expanded_conv_7_squeeze_excite_conv - Frozen
Layer 102: expanded_conv_7_squeeze_excite_relu - Frozen
Layer 103: expanded_conv_7_squeeze_excite_conv_1 - Frozen
Layer 104: re_lu_10 - Frozen
Layer 105: expanded_conv_7_squeeze_excite_mul - Frozen
Layer 106: expanded_conv_7_project - Frozen
Layer 107: expanded_conv_7_project_bn - Frozen
Layer 108: expanded_conv_7_add - Frozen
Layer 109: expanded_conv_8_expand - Frozen
Layer 110: expanded_conv_8_expand_bn - Frozen
Layer 111: activation_11 - Frozen
Layer 112: expanded_conv_8_depthwise_pad - Frozen
Layer 113: expanded_conv_8_depthwise - Frozen
Layer 114: expanded_conv_8_depthwise_bn - Frozen
Layer 115: activation_12 - Frozen
Layer 116: expanded_conv_8_squeeze_excite_avg_pool - Frozen
Layer 117: expanded_conv_8_squeeze_excite_conv - Frozen
Layer 118: expanded_conv_8_squeeze_excite_relu - Frozen
Layer 119: expanded_conv_8_squeeze_excite_conv_1 - Frozen
Layer 120: re_lu_11 - Frozen
Layer 121: expanded_conv_8_squeeze_excite_mul - Frozen
Layer 122: expanded_conv_8_project - Frozen
Layer 123: expanded_conv_8_project_bn - Frozen
Layer 124: expanded_conv_9_expand - Frozen
Layer 125: expanded_conv_9_expand_bn - Frozen
Layer 126: activation_13 - Frozen
Layer 127: expanded_conv_9_depthwise - Frozen
Layer 128: expanded_conv_9_depthwise_bn - Frozen
Layer 129: activation_14 - Frozen
Layer 130: expanded_conv_9_squeeze_excite_avg_pool - Frozen
Layer 131: expanded_conv_9_squeeze_excite_conv - Frozen
Layer 132: expanded_conv_9_squeeze_excite_relu - Frozen
Layer 133: expanded_conv_9_squeeze_excite_conv_1 - Frozen
Layer 134: re_lu_12 - Frozen
Layer 135: expanded_conv_9_squeeze_excite_mul - Frozen
Layer 136: expanded_conv_9_project - Frozen
Layer 137: expanded_conv_9_project_bn - Frozen
Layer 138: expanded_conv_9_add - Frozen
Layer 139: expanded_conv_10_expand - Frozen
Layer 140: expanded_conv_10_expand_bn - Frozen
Layer 141: activation_15 - Frozen
Layer 142: expanded_conv_10_depthwise - Frozen
Layer 143: expanded_conv_10_depthwise_bn - Frozen
Layer 144: activation_16 - Frozen
Layer 145: expanded_conv_10_squeeze_excite_avg_pool - Frozen
Layer 146: expanded_conv_10_squeeze_excite_conv - Frozen
Layer 147: expanded_conv_10_squeeze_excite_relu - Frozen
Layer 148: expanded_conv_10_squeeze_excite_conv_1 - Frozen
Layer 149: re_lu_13 - Frozen
Layer 150: expanded_conv_10_squeeze_excite_mul - Frozen
Layer 151: expanded_conv_10_project - Frozen
Layer 152: expanded_conv_10_project_bn - Frozen
Layer 153: expanded_conv_10_add - Frozen
Layer 154: conv_1 - Frozen
Layer 155: conv_1_bn - Frozen
Layer 156: activation_17 - Frozen
Layer 157: global_average_pooling2d - Trainable
Layer 158: dense - Trainable
Layer 159: dropout - Trainable
Layer 160: dense_1 - Trainable
Layer 161: dropout_1 - Trainable
Layer 162: dense_2 - Trainable

Total layers: 163
Trainable layers: 6
Frozen layers: 157
Trainable parameters: 181,253 (16.18% of total)
Total parameters: 1,120,373

Step 4: Starting progressive fine-tuning...

Starting progressive fine-tuning process...
Identified 120 blocks in MobileNetV3Small
Block 0: 1 layers
Block 1: 1 layers
Block 2: 1 layers
Block 3: 1 layers
Block 4: 1 layers
Block 5: 1 layers
Block 6: 1 layers
Block 7: 1 layers
Block 8: 1 layers
Block 9: 1 layers
Block 10: 1 layers
Block 11: 1 layers
Block 12: 1 layers
Block 13: 1 layers
Block 14: 1 layers
Block 15: 1 layers
Block 16: 1 layers
Block 17: 1 layers
Block 18: 1 layers
Block 19: 1 layers
Block 20: 1 layers
Block 21: 1 layers
Block 22: 1 layers
Block 23: 1 layers
Block 24: 1 layers
Block 25: 1 layers
Block 26: 1 layers
Block 27: 1 layers
Block 28: 1 layers
Block 29: 1 layers
Block 30: 1 layers
Block 31: 1 layers
Block 32: 1 layers
Block 33: 1 layers
Block 34: 1 layers
Block 35: 1 layers
Block 36: 1 layers
Block 37: 1 layers
Block 38: 1 layers
Block 39: 1 layers
Block 40: 1 layers
Block 41: 1 layers
Block 42: 1 layers
Block 43: 1 layers
Block 44: 1 layers
Block 45: 1 layers
Block 46: 1 layers
Block 47: 1 layers
Block 48: 1 layers
Block 49: 1 layers
Block 50: 1 layers
Block 51: 1 layers
Block 52: 1 layers
Block 53: 1 layers
Block 54: 1 layers
Block 55: 1 layers
Block 56: 1 layers
Block 57: 1 layers
Block 58: 1 layers
Block 59: 1 layers
Block 60: 1 layers
Block 61: 1 layers
Block 62: 1 layers
Block 63: 1 layers
Block 64: 1 layers
Block 65: 1 layers
Block 66: 1 layers
Block 67: 1 layers
Block 68: 1 layers
Block 69: 1 layers
Block 70: 1 layers
Block 71: 1 layers
Block 72: 1 layers
Block 73: 1 layers
Block 74: 1 layers
Block 75: 1 layers
Block 76: 1 layers
Block 77: 1 layers
Block 78: 1 layers
Block 79: 1 layers
Block 80: 1 layers
Block 81: 1 layers
Block 82: 1 layers
Block 83: 1 layers
Block 84: 1 layers
Block 85: 1 layers
Block 86: 1 layers
Block 87: 1 layers
Block 88: 1 layers
Block 89: 1 layers
Block 90: 1 layers
Block 91: 1 layers
Block 92: 1 layers
Block 93: 1 layers
Block 94: 1 layers
Block 95: 1 layers
Block 96: 1 layers
Block 97: 1 layers
Block 98: 1 layers
Block 99: 1 layers
Block 100: 1 layers
Block 101: 1 layers
Block 102: 1 layers
Block 103: 1 layers
Block 104: 1 layers
Block 105: 1 layers
Block 106: 1 layers
Block 107: 1 layers
Block 108: 1 layers
Block 109: 1 layers
Block 110: 1 layers
Block 111: 1 layers
Block 112: 1 layers
Block 113: 1 layers
Block 114: 1 layers
Block 115: 1 layers
Block 116: 1 layers
Block 117: 1 layers
Block 118: 1 layers
Block 119: 3 layers

=== Phase 1/4 ===
Phase 1: Training only the classification head (base model fully frozen)
Learning rate for phase 1: 0.000300
Training phase 1 for 5 epochs...
Epoch 1/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.2753 - loss: 1.7592   
Epoch 1: val_accuracy improved from -inf to 0.71595, saving model to model_checkpoint_phase_1.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 3s/step - accuracy: 0.2802 - loss: 1.7457 - val_accuracy: 0.7160 - val_loss: 0.9003 - learning_rate: 3.0000e-04
Epoch 2/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.5842 - loss: 1.0150 
Epoch 2: val_accuracy improved from 0.71595 to 0.76071, saving model to model_checkpoint_phase_1.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 63s 3s/step - accuracy: 0.5855 - loss: 1.0120 - val_accuracy: 0.7607 - val_loss: 0.6581 - learning_rate: 3.0000e-04
Epoch 3/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.6795 - loss: 0.8045 
Epoch 3: val_accuracy improved from 0.76071 to 0.78000, saving model to model_checkpoint_phase_1.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 63s 3s/step - accuracy: 0.6799 - loss: 0.8035 - val_accuracy: 0.7800 - val_loss: 0.5799 - learning_rate: 3.0000e-04
Epoch 4/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7140 - loss: 0.7118 
Epoch 4: val_accuracy improved from 0.78000 to 0.79262, saving model to model_checkpoint_phase_1.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 64s 3s/step - accuracy: 0.7145 - loss: 0.7108 - val_accuracy: 0.7926 - val_loss: 0.5413 - learning_rate: 3.0000e-04
Epoch 5/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7378 - loss: 0.6584 
Epoch 5: val_accuracy improved from 0.79262 to 0.80190, saving model to model_checkpoint_phase_1.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 63s 3s/step - accuracy: 0.7383 - loss: 0.6575 - val_accuracy: 0.8019 - val_loss: 0.5172 - learning_rate: 3.0000e-04
Restoring model weights from the end of the best epoch: 5.
New best validation accuracy: 0.8019

=== Phase 2/4 ===
Unfrozen 3 layers in phase 2
Learning rate for phase 2: 0.000210
Training phase 2 for 5 epochs...
Epoch 1/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.6186 - loss: 1.0333  
Epoch 1: val_accuracy improved from -inf to 0.63476, saving model to model_checkpoint_phase_2.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 73s 3s/step - accuracy: 0.6215 - loss: 1.0235 - val_accuracy: 0.6348 - val_loss: 0.9883 - learning_rate: 2.1000e-04
Epoch 2/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7496 - loss: 0.6470 
Epoch 2: val_accuracy improved from 0.63476 to 0.67548, saving model to model_checkpoint_phase_2.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 67s 3s/step - accuracy: 0.7497 - loss: 0.6465 - val_accuracy: 0.6755 - val_loss: 0.8512 - learning_rate: 2.1000e-04
Epoch 3/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7648 - loss: 0.5995 
Epoch 3: val_accuracy improved from 0.67548 to 0.68310, saving model to model_checkpoint_phase_2.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 68s 3s/step - accuracy: 0.7650 - loss: 0.5994 - val_accuracy: 0.6831 - val_loss: 0.8659 - learning_rate: 2.1000e-04
Epoch 4/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7763 - loss: 0.5749 
Epoch 4: val_accuracy improved from 0.68310 to 0.69571, saving model to model_checkpoint_phase_2.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 69s 3s/step - accuracy: 0.7765 - loss: 0.5745 - val_accuracy: 0.6957 - val_loss: 0.8393 - learning_rate: 2.1000e-04
Epoch 5/5
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7928 - loss: 0.5406   
Epoch 5: val_accuracy did not improve from 0.69571
20/20 ━━━━━━━━━━━━━━━━━━━━ 69s 3s/step - accuracy: 0.7925 - loss: 0.5410 - val_accuracy: 0.6874 - val_loss: 0.8441 - learning_rate: 2.1000e-04
Restoring model weights from the end of the best epoch: 4.

=== Phase 3/4 ===
Unfrozen 5 layers in phase 3
Learning rate for phase 3: 0.000147
Training phase 3 for 8 epochs...
Epoch 1/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7838 - loss: 0.5625  
Epoch 1: val_accuracy improved from -inf to 0.70095, saving model to model_checkpoint_phase_3.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 74s 4s/step - accuracy: 0.7840 - loss: 0.5618 - val_accuracy: 0.7010 - val_loss: 0.8105 - learning_rate: 1.4700e-04
Epoch 2/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7916 - loss: 0.5312 
Epoch 2: val_accuracy did not improve from 0.70095
20/20 ━━━━━━━━━━━━━━━━━━━━ 69s 3s/step - accuracy: 0.7916 - loss: 0.5311 - val_accuracy: 0.6979 - val_loss: 0.8327 - learning_rate: 1.4700e-04
Epoch 3/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.7996 - loss: 0.5151   
Epoch 3: val_accuracy improved from 0.70095 to 0.70548, saving model to model_checkpoint_phase_3.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.7998 - loss: 0.5152 - val_accuracy: 0.7055 - val_loss: 0.8097 - learning_rate: 1.4700e-04
Epoch 4/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8078 - loss: 0.5022 
Epoch 4: val_accuracy improved from 0.70548 to 0.70952, saving model to model_checkpoint_phase_3.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8078 - loss: 0.5022 - val_accuracy: 0.7095 - val_loss: 0.8033 - learning_rate: 1.4700e-04
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8078 - loss: 0.5022 - val_accuracy: 0.7095 - val_loss: 0.8033 - learning_rate: 1.4700e-04
Epoch 5/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8146 - loss: 0.4886
Epoch 5: val_accuracy improved from 0.70952 to 0.71286, saving model to model_checkpoint_phase_3.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8146 - loss: 0.4884 - val_accuracy: 0.7129 - val_loss: 0.7944 - learning_rate: 1.4700e-04
Epoch 6/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8180 - loss: 0.4794
Epoch 6: val_accuracy improved from 0.71286 to 0.72810, saving model to model_checkpoint_phase_3.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8180 - loss: 0.4791 - val_accuracy: 0.7281 - val_loss: 0.7549 - learning_rate: 1.4700e-04
Epoch 7/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8183 - loss: 0.4654
Epoch 7: val_accuracy improved from 0.72810 to 0.73857, saving model to model_checkpoint_phase_3.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8184 - loss: 0.4653 - val_accuracy: 0.7386 - val_loss: 0.7166 - learning_rate: 1.4700e-04
Epoch 8/8
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8205 - loss: 0.4661 
Epoch 8: val_accuracy did not improve from 0.73857
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8207 - loss: 0.4658 - val_accuracy: 0.7336 - val_loss: 0.7406 - learning_rate: 1.4700e-04
Restoring model weights from the end of the best epoch: 7.

=== Phase 4/4 ===
Unfrozen 8 layers in phase 4
Learning rate for phase 4: 0.000103
Training phase 4 for 10 epochs...
Epoch 1/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8223 - loss: 0.4642  
Epoch 1: val_accuracy improved from -inf to 0.74071, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 79s 4s/step - accuracy: 0.8224 - loss: 0.4637 - val_accuracy: 0.7407 - val_loss: 0.7204 - learning_rate: 1.0290e-04
Epoch 2/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8377 - loss: 0.4391  
Epoch 2: val_accuracy improved from 0.74071 to 0.74833, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 72s 4s/step - accuracy: 0.8376 - loss: 0.4394 - val_accuracy: 0.7483 - val_loss: 0.6997 - learning_rate: 1.0290e-04
Epoch 3/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8360 - loss: 0.4342 
Epoch 3: val_accuracy improved from 0.74833 to 0.76238, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8360 - loss: 0.4342 - val_accuracy: 0.7624 - val_loss: 0.6636 - learning_rate: 1.0290e-04
Epoch 4/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8412 - loss: 0.4239 
Epoch 4: val_accuracy improved from 0.76238 to 0.77476, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8412 - loss: 0.4239 - val_accuracy: 0.7748 - val_loss: 0.6331 - learning_rate: 1.0290e-04
Epoch 5/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8410 - loss: 0.4093  
Epoch 5: val_accuracy did not improve from 0.77476
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8410 - loss: 0.4095 - val_accuracy: 0.7695 - val_loss: 0.6507 - learning_rate: 1.0290e-04
Epoch 6/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8489 - loss: 0.3996 
Epoch 6: val_accuracy improved from 0.77476 to 0.77738, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8490 - loss: 0.3996 - val_accuracy: 0.7774 - val_loss: 0.6238 - learning_rate: 1.0290e-04
Epoch 7/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8494 - loss: 0.3974 
Epoch 7: val_accuracy improved from 0.77738 to 0.78571, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8494 - loss: 0.3975 - val_accuracy: 0.7857 - val_loss: 0.6024 - learning_rate: 1.0290e-04
Epoch 8/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8566 - loss: 0.3827 
Epoch 8: val_accuracy improved from 0.78571 to 0.78905, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 70s 4s/step - accuracy: 0.8565 - loss: 0.3828 - val_accuracy: 0.7890 - val_loss: 0.5908 - learning_rate: 1.0290e-04
Epoch 9/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8569 - loss: 0.3810 
Epoch 9: val_accuracy improved from 0.78905 to 0.79476, saving model to model_checkpoint_phase_4.h5
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8569 - loss: 0.3810 - val_accuracy: 0.7948 - val_loss: 0.5822 - learning_rate: 1.0290e-04
Epoch 10/10
20/20 ━━━━━━━━━━━━━━━━━━━━ 0s 3s/step - accuracy: 0.8612 - loss: 0.3702 
Epoch 10: val_accuracy did not improve from 0.79476
20/20 ━━━━━━━━━━━━━━━━━━━━ 71s 4s/step - accuracy: 0.8612 - loss: 0.3702 - val_accuracy: 0.7936 - val_loss: 0.5812 - learning_rate: 1.0290e-04
Restoring model weights from the end of the best epoch: 9.

Applying best weights found during progressive training...
WARNING:absl:You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`.
Model saved to nsfw_classifier_progressive_finetuned.h5

Step 5: Evaluating the fine-tuned model...

Evaluating model performance...
5/5 ━━━━━━━━━━━━━━━━━━━━ 15s 2s/step
2025-04-21 17:46:44.729144: I tensorflow/core/framework/local_rendezvous.cc:407] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence

Classification Report:
              precision    recall  f1-score   support

     Drawing       0.74      0.76      0.75       840
      Hentai       0.84      0.75      0.80       840
     Neutral       0.79      0.85      0.82       840
        Porn       0.84      0.83      0.83       840
        Sexy       0.80      0.81      0.80       840

    accuracy                           0.80      4200
   macro avg       0.80      0.80      0.80      4200
weighted avg       0.80      0.80      0.80      4200

Overall accuracy: 0.8010

NSFW content classification model fine-tuning completed!
Final model accuracy: 0.8010
Model saved to: nsfw_classifier_progressive_finetuned.h5
Training history plot saved to: training_history.png
Confusion matrix saved to: confusion_matrix.png
PS D:\hari\LSPD> 